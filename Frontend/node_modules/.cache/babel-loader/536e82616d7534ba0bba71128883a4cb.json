{"ast":null,"code":"var _jsxFileName = \"/Users/vrushalij/Desktop/Submission/css_updated/Frontend/src/Welcome.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport UserStorage from './stores/UserStorage';\nimport VoterContract from './VoterContract';\nimport swal from \"sweetalert2\";\nimport Candidate from \"./Candidate\";\nimport Loader from \"react-loader-spinner\";\nimport web3 from './web3';\nimport { Link, Redirect } from 'react-router-dom';\nimport './App.css';\nconst style = {\n  width: \"30%\",\n  marginLeft: \"0%\",\n  height: \"50px\",\n  marginTop: \"40px\",\n  marginBottom: \"30px\",\n  fontSize: \"20px\",\n  border: \"none\",\n  borderRight: \"solid #2eca6a 3px\",\n  borderBottom: \"solid #2eca6a 3px\",\n  borderTop: \"solid 3px lightgrey\",\n  borderLeft: \"solid 3px lightgrey\"\n};\n\nclass Welcome extends Component {\n  constructor(props) {\n    super(props);\n\n    this.showDetails = candidate_id => {\n      if (candidate_id) {\n        const candidate = this.state.candidates.filter(candidate => candidate.candidate_id === candidate_id);\n        this.props.history.push({\n          pathname: \"/CandidateDetail\",\n          state: {\n            candidateDetails: candidate\n          }\n        });\n      }\n    };\n\n    this.state = {\n      candidates: [],\n      candidate_id: 0,\n      max_id: '',\n      loading: true,\n      success: null,\n      username: '',\n      password: '',\n      buttonDisabled: false\n    };\n    this.handleCandidateChange = this.handleCandidateChange.bind(this);\n    this.vote = this.vote.bind(this);\n  }\n\n  doLogout() {\n    UserStorage.username = '';\n    this.props.history.push(\"/Login\");\n  }\n\n  async componentDidMount() {\n    const response = await fetch('http://localhost:3003/candidateCount', {\n      method: 'get',\n      headers: {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      }\n    });\n    let result = await response.json();\n    console.log(\"Count from DB is\", result.data[0]);\n    var count = result.data[0].count;\n    console.log(\"count is: \" + count);\n    const responseStartFrom = await fetch('http://localhost:3003/getStartFrom', {\n      method: 'get',\n      headers: {\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      }\n    });\n    let resultStartFrom = await responseStartFrom.json();\n    console.log(\"Startfro, from DB is\", resultStartFrom.data[0]);\n    var startfrom = result.data[0].count;\n    console.log(\"count is: \" + startfrom);\n    var accounts = await web3.eth.getAccounts();\n    console.log(\"web3\", accounts);\n    console.log(\"aing: \" + accounts[0]);\n    web3.eth.defaultAccount = accounts[0];\n    const candidates = await VoterContract.methods.getCandidates(count, startfrom).call();\n    console.log(\"number of responses from blockchain: \" + candidates.length);\n    console.log(\"candidates recieved from blockchain: \" + JSON.stringify(candidates)); //const candi = await VoterContract.methods.getCandidates(3).call();\n\n    let candidates2 = [];\n\n    for (let candidate of candidates) {\n      if (candidate.id != \"0\") {\n        candidates2.push({\n          candidate_id: candidate.candidate_id,\n          first_name: candidate.first_name,\n          last_name: candidate.last_name,\n          candidate_info: candidate.candidate_info,\n          candidate_desc: candidate.candidate_desc,\n          vote_count: candidate.vote_count\n        });\n      }\n    }\n\n    this.setState({\n      candidates: candidates2,\n      loading: false\n    });\n  }\n\n  handleCandidateChange(event) {\n    this.setState({\n      candidate_id: event.target.value\n    });\n  }\n\n  async vote() {\n    console.log(this.state.candidate_id);\n\n    if (this.state.candidate_id !== 0) {\n      var accounts = await web3.eth.getAccounts();\n      console.log(\"web3\", accounts);\n      console.log(\"aing: \" + accounts[0]);\n      web3.eth.defaultAccount = accounts[0];\n      var result = await VoterContract.methods.vote(this.state.candidate_id).send({\n        from: accounts[0]\n      });\n      console.log(\"result\" + JSON.stringify(result[0]));\n\n      if (result[0] == 1) {\n        swal.fire({\n          icon: 'success',\n          title: \"Voting SuccesFull!\",\n          text: \"You have succesfully voted your candidate\",\n          type: \"Success\",\n          confirmButtonText: \"OK\"\n        });\n      } else {\n        swal.fire({\n          icon: 'error',\n          title: 'Voting failed',\n          text: 'Vote from this metamask address has already been casted',\n          confirmButtonText: \"OK\"\n        });\n      }\n    } else {\n      swal.fire({\n        icon: 'error',\n        title: 'Voting failed',\n        text: 'Please Select a Candidate',\n        confirmButtonText: \"OK\"\n      });\n    }\n  }\n\n  render() {\n    const {\n      loading,\n      candidates\n    } = this.state;\n    let dropDown = null;\n    let button = null;\n    let ui = null;\n\n    if (loading && candidates.length == 0) {\n      ui = React.createElement(Loader, {\n        type: \"ThreeDots\",\n        color: \"#00BFFF\",\n        height: 100,\n        width: 100,\n        timeout: 3000,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      });\n    }\n\n    if (candidates.length == 0) {\n      ui = React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, \"No candidates to load Kindly add candidate info\");\n    }\n\n    if (candidates.length != 0) {\n      ui = candidates.map(candidate => {\n        return React.createElement(Candidate, {\n          showDetails: this.showDetails,\n          key: candidate.candidate_id,\n          candidate: candidate,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        });\n      });\n      dropDown = React.createElement(\"select\", {\n        style: style,\n        onChange: this.handleCandidateChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"Select Candidate for Vote\"), candidates.map(candidate => React.createElement(\"option\", {\n        key: candidate.candidate_id,\n        value: candidate.candidate_id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, candidate.first_name + \" \" + candidate.last_name)));\n      button = React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn vote\",\n        onClick: this.vote,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, \"Vote\"));\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"navbar-nav\",\n      id: \"navg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \" brand\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Electronic\")), React.createElement(\"li\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: \" colorb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, \"Ballot\")), React.createElement(\"li\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/welcome\",\n      className: \"nav-link welcome\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, \" Welcome\")), React.createElement(\"li\", {\n      className: \"nav-item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/welcome\",\n      className: \"nav-link user uname\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, \" Vrushali!\")))), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, dropDown, button, ui));\n  }\n\n} //Export The Main Component\n\n\nexport default Welcome;","map":{"version":3,"sources":["/Users/vrushalij/Desktop/Submission/css_updated/Frontend/src/Welcome.js"],"names":["React","Component","axios","UserStorage","VoterContract","swal","Candidate","Loader","web3","Link","Redirect","style","width","marginLeft","height","marginTop","marginBottom","fontSize","border","borderRight","borderBottom","borderTop","borderLeft","Welcome","constructor","props","showDetails","candidate_id","candidate","state","candidates","filter","history","push","pathname","candidateDetails","max_id","loading","success","username","password","buttonDisabled","handleCandidateChange","bind","vote","doLogout","componentDidMount","response","fetch","method","headers","result","json","console","log","data","count","responseStartFrom","resultStartFrom","startfrom","accounts","eth","getAccounts","defaultAccount","methods","getCandidates","call","length","JSON","stringify","candidates2","id","first_name","last_name","candidate_info","candidate_desc","vote_count","setState","event","target","value","send","from","fire","icon","title","text","type","confirmButtonText","render","dropDown","button","ui","map"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport UserStorage from './stores/UserStorage';\nimport VoterContract from './VoterContract';\nimport swal from \"sweetalert2\";\nimport Candidate from \"./Candidate\";\nimport Loader from \"react-loader-spinner\";\nimport web3 from './web3';\nimport { Link, Redirect } from 'react-router-dom';\nimport './App.css';\n\nconst style = {\n  width: \"30%\",\n  marginLeft: \"0%\",\n  height: \"50px\",\n  marginTop: \"40px\",\n  marginBottom: \"30px\",\n  fontSize: \"20px\",\n  border: \"none\",\n  borderRight: \"solid #2eca6a 3px\",\n  borderBottom: \"solid #2eca6a 3px\",\n  borderTop: \"solid 3px lightgrey\",\n  borderLeft: \"solid 3px lightgrey\",\n};\n\nclass Welcome extends Component {\n    constructor(props){\n        super(props);\n        this.state={\n            candidates: [],\n            candidate_id:0,\n            max_id:'',\n            loading: true,\n            success: null,\n            username : '',\n            password : '',\n            buttonDisabled : false\n        }\n        this.handleCandidateChange = this.handleCandidateChange.bind(this);\n        this.vote= this.vote.bind(this);\n      }\n    \n\n    doLogout(){\n        UserStorage.username='';\n        this.props.history.push(\"/Login\");\n    }\n    async componentDidMount(){\n        \n        const response = await fetch('http://localhost:3003/candidateCount', {\n          method: 'get',\n          headers: {\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json'\n            }\n          }\n        });\n        \n        let result = await response.json();\n        console.log(\"Count from DB is\", result.data[0]);\n        var count = result.data[0].count;\n        console.log(\"count is: \"+count);\n        \n        const responseStartFrom = await fetch('http://localhost:3003/getStartFrom', {\n          method: 'get',\n          headers: {\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json'\n            }\n          }\n        });\n\n        let resultStartFrom = await responseStartFrom.json();\n        console.log(\"Startfro, from DB is\", resultStartFrom.data[0]);\n        var startfrom = result.data[0].count;\n        console.log(\"count is: \"+startfrom);\n\n        var accounts = await web3.eth.getAccounts();\n        console.log(\"web3\", accounts);\n        console.log(\"aing: \"+ accounts[0]);\n        web3.eth.defaultAccount = accounts[0];\n           \n            const candidates = await VoterContract.methods.getCandidates(count,startfrom).call();\n            console.log(\"number of responses from blockchain: \"+candidates.length)\n            console.log(\"candidates recieved from blockchain: \"+JSON.stringify(candidates));\n            //const candi = await VoterContract.methods.getCandidates(3).call();\n            let candidates2 = [];\n            \n            for (let candidate of candidates) {\n              if (candidate.id != \"0\") {\n                candidates2.push({\n                  candidate_id: candidate.candidate_id,\n                  first_name: candidate.first_name,\n                  last_name: candidate.last_name,\n                  candidate_info: candidate.candidate_info,\n                  candidate_desc: candidate.candidate_desc,\n                  vote_count: candidate.vote_count\n                });\n              }\n            }\n            this.setState({ candidates: candidates2, loading: false });\n           \n      };\n      handleCandidateChange(event) {\n        this.setState({ candidate_id: event.target.value });\n      }\n      showDetails = (candidate_id) => {\n        if (candidate_id) {\n          const candidate = this.state.candidates.filter(\n            (candidate) => candidate.candidate_id === candidate_id\n          );\n          this.props.history.push({\n            pathname: \"/CandidateDetail\",\n            state: { candidateDetails: candidate },\n          });\n        }\n      };\n      async vote() {\n        console.log(this.state.candidate_id);\n        if (this.state.candidate_id !== 0) {\n            var accounts = await web3.eth.getAccounts();\n            console.log(\"web3\", accounts);\n            console.log(\"aing: \"+ accounts[0]);\n            web3.eth.defaultAccount = accounts[0];\n            var result = await VoterContract.methods.vote(this.state.candidate_id).send({from: accounts[0]});\n            console.log(\"result\"+ JSON.stringify(result[0]));\n            if(result[0]== 1){\n              \n                swal.fire({\n                    icon: 'success',\n                    title: \"Voting SuccesFull!\",\n                    text: \"You have succesfully voted your candidate\",\n                    type: \"Success\",\n                    confirmButtonText: \"OK\"\n                  });\n            }else{\n                swal.fire({\n                    icon: 'error',\n                    title: 'Voting failed',\n                    text: 'Vote from this metamask address has already been casted',\n                    confirmButtonText: \"OK\"\n                });\n            }\n        } else {\n            swal.fire({\n                icon: 'error',\n                title: 'Voting failed',\n                text: 'Please Select a Candidate',\n                confirmButtonText: \"OK\"\n            });\n        }\n      }\n\n    render() {\n        const { loading, candidates } = this.state;\n    let dropDown = null;\n    let button = null;\n    let ui = null;\n    if (loading && candidates.length ==0) {\n      ui =   <Loader\n      type=\"ThreeDots\"\n      color=\"#00BFFF\"\n      height={100}\n      width={100}\n      timeout={3000}\n    />;\n    }\n    if(candidates.length ==0){\n      ui = <div>No candidates to load Kindly add candidate info</div>\n    }\n    if(candidates.length !=0){\n      ui = candidates.map((candidate) => {\n        return (\n          <Candidate\n            showDetails={this.showDetails}\n            key={candidate.candidate_id}\n            candidate={candidate}\n          />\n        );\n      });\n      \n      dropDown =  (\n        <select style={style} onChange={this.handleCandidateChange}>\n          <option>Select Candidate for Vote</option>\n          {candidates.map((candidate) => (\n            <option key={candidate.candidate_id} value={candidate.candidate_id}>\n              {candidate.first_name + \" \" + candidate.last_name}\n            </option>\n          ))}\n        </select>\n      );\n        button = (\n        <div>\n          <button className=\"btn vote\" onClick={this.vote}>\n            Vote\n          </button>\n        </div>\n      );\n    \n    }\n\n        return ( \n            <div className=\"container\">\n                        <div className= \"header\">\n                        <ul className=\"navbar-nav\" id=\"navg\">\n                           \n                            <li className=\"nav-item\">\n                                <a className=\" brand\">Electronic</a>\n                            </li>\n                            <li className=\"nav-item\">\n                                <a className=\" colorb\">Ballot</a>\n                            </li>\n                            <li className=\"nav-item\">\n                                <Link to=\"/welcome\" className=\"nav-link welcome\"> Welcome\n                            </Link>\n                           </li>\n                           {/* <li className=\"nav-item\">\n                                <Link to=\"/AdminLogin\" className=\"nav-link user\"> {this.props.location.state.username}\n                            </Link>\n                           </li> */}\n                           <li className=\"nav-item\">\n                                <Link to=\"/welcome\" className=\"nav-link user uname\"> Vrushali!\n                            </Link>\n                           </li> \n\n                        </ul>\n                    </div>\n                    <div className=\"row\">\n        {dropDown}\n        {button}\n        {ui}\n      </div>\n      </div>\n      ); \n    }\n}\n  //Export The Main Component\n  export default Welcome;"]},"metadata":{},"sourceType":"module"}